# [강의자료] ESP32와 릴레이를 이용한 워터 펌프 제어

본 자료는 워터 펌프의 기본 구동 원리를 이해하고, ESP32와 릴레이 모듈을 활용하여 이를 안전하게 제어하는 방법을 다룹니다.

---

## 1. 워터 펌프의 이해 (이론)

### 1.1 워터 펌프 모터의 정의
* [cite_start]**정의**: 전기 에너지를 물리적인 회전력으로 변환하여 물을 흡입하고 배출하는 동력 장치입니다[cite: 16, 110].
* [cite_start]**구성**: 주요 구성 요소로는 모터, 회전 임펠러, 케이싱 등이 있습니다[cite: 15, 75, 76].

### 1.2 구동 원리: 원심력과 압력 차
워터 펌프는 다음과 같은 물리적 원리를 통해 물을 이동시킵니다.
1. [cite_start]**회전력 전달**: 모터가 전기 에너지를 회전력으로 변환하여 임펠러를 돌립니다[cite: 17, 30, 37].
2. [cite_start]**원심력 발생**: 회전하는 임펠러에 의해 물이 바깥쪽으로 밀려나는 원심력이 발생합니다[cite: 44, 64].
3. [cite_start]**압력 차 형성**: 원심력에 의해 상대적으로 중앙부는 **저압(밀도 낮음)**, 외곽부는 **고압(밀도 높음)** 상태가 됩니다[cite: 44].
4. [cite_start]**유체의 흐름**: 유체는 압력이 높은 곳에서 낮은 곳으로 흐르는 성질이 있어, 흡입구(저압)를 통해 들어온 물이 배출구(고압)로 나가게 됩니다[cite: 50, 51, 52].

---

## 2. 제어 회로 구성의 핵심: 릴레이 (이론)

### 2.1 ESP32 직접 제어의 한계
* [cite_start]**전압/전류 부족**: ESP32 GPIO 핀은 최대 3.3V, 40mA까지만 출력이 가능하여 펌프를 직접 돌릴 힘이 없습니다[cite: 81, 90].
* [cite_start]**역기전력 위험**: 펌프 정지 시 발생하는 고전압 충격이 MCU(ESP32)에 치명적인 영향을 줄 수 있습니다[cite: 82, 91].

### 2.2 릴레이 모듈의 역할

* [cite_start]**전기적 절연**: 제어부(ESP32)와 구동부(펌프) 회로를 물리적으로 분리하여 MCU를 보호합니다[cite: 85, 94, 95].
* [cite_start]**고전력 스위칭**: 작은 신호(3.3V)로 큰 전원(12V, 220V 등) 제품을 안전하게 On/Off 할 수 있습니다[cite: 86, 96].
* [cite_start]**속도 조절 팁**: 단순 On/Off가 아닌 속도 조절(PWM)이 필요한 경우, L9110S와 같은 모터 드라이버를 별도로 사용해야 합니다[cite: 107].

---

## 3. 실습: 워터 펌프 On/Off 제어하기

### 3.1 핀 요약 및 주의사항
* [cite_start]**VCC (빨간 선)**: 전원 입력 (보통 3V ~ 6V DC)[cite: 112].
* [cite_start]**GND (검은 선)**: 공통 접지 (-)[cite: 113].
* [cite_start]**주의**: ESP32의 GPIO 핀에 펌프를 직접 연결하지 말고, 반드시 릴레이나 모터 드라이버를 거쳐야 합니다[cite: 114, 115].

### 3.2 하드웨어 연결 (회로도 구성)
| 컴포넌트 | 핀 (From) | 핀 (To) | 비고 |
| :--- | :--- | :--- | :--- |
| **릴레이 모듈** | ESP32 GPIO 18 | Relay IN | 제어 신호 |
| | ESP32 5V | Relay VCC | 모듈 구동 전원 |
| | ESP32 GND | Relay GND | 공통 접지 |
| **워터 펌프** | 외부 전원 (+) | Relay COM | 공통 단자 |
| | Relay NO | 펌프 빨간선 | Normal Open 단자 |
| | 외부 전원 (-) | 펌프 검은선 | 접지 연결 |



### 3.3 실습 코드 (Arduino IDE)
다음은 5초 동안 펌프를 작동시키고 3초 동안 멈추는 기본 예제 코드입니다.

```cpp
// 핀 설정
const int RELAY_PIN = 18; 

void setup() {
  // 릴레이 핀을 출력 모드로 설정
  pinMode(RELAY_PIN, OUTPUT);
  Serial.begin(115200);
  Serial.println("워터 펌프 제어 시스템 가동...");
}

void loop() {
  // 펌프 가동
  Serial.println("펌프 작동 중 (ON)");
  digitalWrite(RELAY_PIN, HIGH); 
  delay(5000); // 5초 대기

  // 펌프 정지
  Serial.println("펌프 정지 (OFF)");
  digitalWrite(RELAY_PIN, LOW);
  delay(3000); // 3초 대기
}
