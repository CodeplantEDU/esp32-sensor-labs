
# 조도센서(LDR 모듈, VCC/GND/DO/AO) - 실습 1, 실습 2, 실습 3 (ESP32 + MicroPython)

ESP32에서 **조도(밝기)** 를 읽는 실습 세트입니다. 이 모듈은 보통 **AO(아날로그 출력)** 와 **DO(디지털 출력)** 를 동시에 제공합니다.

---

## 0) 이 실습의 한 줄 목표
- **AO로 밝기 값을 연속적으로 읽고(부드러운 숫자 변화)**
- **DO로 ‘밝다/어둡다’ 판정을 빠르게 읽는다(0/1)**

---

## 1) 준비물
- ESP32 DevKit (MicroPython)
- 조도센서(LDR) 모듈 (핀: **VCC / GND / DO / AO**)
- 점퍼선
- (선택) 미니 브레드보드

---
## 2) 배선(핀 연결)
> **중요(전압):** 이 모듈은 VCC에 따라 AO 최대 전압도 같이 올라갑니다. ESP32 ADC는 **3.3V 기준**이므로 **VCC는 3V3에 연결**하는 것을 권장합니다.

- 센서 **VCC** → ESP32 **3V3**
- 센서 **GND** → ESP32 **GND**
- 센서 **AO** → ESP32 **GPIO25** (아날로그 입력)
- 센서 **DO** → ESP32 **GPIO26** (디지털 입력)

### 회로 연결표 (ESP32 + 조도센서)
| 연결 목적 | 출발(부품/핀) | 도착(부품/핀) | 설명(한 줄) |
|---|---|---|---|
| 전원 공급 | ESP32 3V3 | 센서 VCC | 센서에 3.3V 공급(권장) |
| 공통 접지(필수) | ESP32 GND | 센서 GND | 기준점 공유(안 하면 오작동) |
| 아날로그 밝기 값 | 센서 AO | ESP32 GPIO25 | 밝기 값이 연속적으로 변함 |
| 디지털 판정 값 | 센서 DO | ESP32 GPIO26 | 밝다/어둡다 0/1 판정(가변저항 기준) |

### 연결 체크 포인트
- **DO가 계속 0 또는 계속 1**이면: 센서 보드의 **가변저항(파란색 볼륨)** 을 드라이버로 살짝 돌려서 임계값을 맞추세요.
- **AO 값이 0 또는 최대로 고정**되면: VCC/GND 방향, AO 핀 연결(GPIO25)을 다시 확인하세요.
- (참고) GPIO25는 ESP32에서 **ADC2**에 해당합니다. Wi-Fi를 적극적으로 쓰는 프로젝트에서는 ADC가 불안정할 수 있어요(수업 실습에서는 보통 문제 없음).

---
## 3) 코드 파일 목록
- **실습 1 (DO로 밝다/어둡다 판정):** `lab1_ldr_do_digital_read.py`
- **실습 2 (AO로 밝기 연속값 읽기):** `lab2_ldr_ao_analog_read.py`
- **실습 3 (AO + DO 함께 보기/튜닝):** `lab3_ldr_ao_do_combo.py`

---

# 실습 1) DO로 밝다/어둡다 판정 (디지털 출력)

## 1) 이 실습의 한 줄 목표
- **손으로 센서를 가리면(어두워지면) DO가 0/1로 바뀌는 것을 확인**한다.

## 2) 코드 전체 흐름(큰 그림)
1. GPIO26을 입력으로 설정 (DO)
2. while True로 계속 DO 값을 읽어서 출력
3. 필요하면 센서의 가변저항으로 임계값 조절

## 3) 코드 (실습1)
```python
from machine import Pin
import time

# DO -> GPIO26
DO = Pin(26, Pin.IN)

print("[실습1] LDR DO(디지털) 읽기")
print("가변저항을 돌려서 0/1이 잘 바뀌도록 맞춰보세요")

while True:
    val = DO.value()  # 0 또는 1
    if val == 1:
        print("밝음(또는 임계값 이상)")
    else:
        print("어두움(또는 임계값 이하)")
    time.sleep(0.2)
```

## 4) 주요 코드 분석(학생용)
- `Pin(26, Pin.IN)`: 26번 핀을 **입력**으로 만든다.
- `DO.value()`: 지금 센서가 주는 **0/1** 값을 읽는다.
- **가변저항(파란 볼륨)**: DO가 바뀌는 **기준 밝기(임계값)** 를 바꾼다.

---
# 실습 2) AO로 밝기 연속값 읽기 (아날로그 출력)

## 1) 이 실습의 한 줄 목표
- **밝기에 따라 숫자가 ‘연속적으로’ 변하는** AO 값을 확인한다.

## 2) 코드 전체 흐름(큰 그림)
1. GPIO25를 ADC(아날로그 입력)로 설정
2. `read_u16()`로 0~65535 범위의 값을 계속 읽기
3. 보기 편하게 **%** 와 **막대(bar)** 로 출력

## 3) 코드 (실습2)
```python
from machine import Pin, ADC
import time

# AO -> GPIO25 (아날로그 입력)
adc = ADC(Pin(25))

# 입력 전압 범위 설정(대부분 3.3V 측정을 위해 11dB 사용)
# VCC를 3V3에 연결했다면 아래 설정이 무난합니다.
adc.atten(ADC.ATTN_11DB)

print("[실습2] LDR AO(아날로그) 읽기")
print("센서를 손으로 가리거나 빛을 비춰서 값이 어떻게 변하는지 확인")

while True:
    raw = adc.read_u16()  # 0~65535
    pct = int(raw * 100 / 65535)
    bar = "█" * (pct // 5)  # 0~20칸

    print(f"AO raw={raw:5d} | {pct:3d}% | {bar}")
    time.sleep(0.1)
```

## 4) 주요 코드 분석(학생용)
- `ADC(Pin(25))`: 25번 핀을 **아날로그 입력**으로 만든다.
- `adc.read_u16()`: 밝기에 따라 바뀌는 값을 **숫자**로 읽는다.
- 값이 **커지는지/작아지는지**는 모듈 구성에 따라 달라질 수 있어요.
  - 직접 가려 보고 “어두울 때 증가/감소”를 관찰해서 규칙을 정하면 됩니다.

---

# 실습 3) AO + DO 함께 보기 (튜닝/이해용)

## 1) 이 실습의 한 줄 목표
- **AO(연속값)** 와 **DO(0/1 판정)** 를 동시에 보면서,
  DO가 어떤 기준으로 바뀌는지 이해한다.

## 2) 코드 전체 흐름(큰 그림)
1. AO(ADC)와 DO(디지털 입력)를 둘 다 준비
2. while True에서 두 값을 같이 출력
3. (선택) AO 값으로 임계값(threshold)을 만들어 ‘내가 만든 DO’도 출력

## 3) 코드 (실습3)
```python
from machine import Pin, ADC
import time

# AO -> GPIO25, DO -> GPIO26
adc = ADC(Pin(25))
adc.atten(ADC.ATTN_11DB)
DO = Pin(26, Pin.IN)

# (선택) AO로 임계값을 하나 정해서 판정해보기
# 먼저 대충 한 번 돌려보고, threshold 값을 맞춰보세요.
threshold = 30000  # 0~65535 중간 어딘가(환경마다 다름)

print("[실습3] AO(연속값) + DO(0/1) 같이 보기")
print("1) 센서의 가변저항으로 DO가 잘 바뀌도록 조절")
print("2) threshold를 바꿔서 AO 판정도 같이 맞춰보기")

while True:
    ao = adc.read_u16()
    do = DO.value()

    # AO로 만든 판정(내가 만든 DO)
    my_do = 1 if ao > threshold else 0

    print(f"AO={ao:5d} | DO={do} | my_DO={my_do} (thr={threshold})")
    time.sleep(0.2)
```

## 4) 체크 포인트(자주 막히는 곳)
- **DO가 안 바뀜** → 센서 보드의 **가변저항**을 조금씩 돌려서 임계값을 맞추기
- **AO가 튐/불안정** → 배선 느슨함, GND 연결 불량, 주변 조명(깜빡이는 LED) 영향일 수 있음
- **VCC를 5V로 연결하면** → AO가 3.3V를 넘을 수 있어 ESP32에 위험. **3V3 권장**

---

## (선택) 실습 확장 아이디어
- AO 값이 특정 기준 아래/위면 “야간/주간” 판정해서 다른 동작하기
- AO의 평균(이동평균)을 내서 값이 덜 흔들리게 만들기
- DO만으로 간단한 라이트 스위치 만들기(밝으면 OFF, 어두우면 ON)
